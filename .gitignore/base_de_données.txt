clé API google maps AIzaSyCHZyxMa_m_16KNjwhcQukCvXdSLdyPdBM

CREATE DATABASE gestion_dechets;
USE gestion_dechets;

-- Table des utilisateurs (citoyens, entreprises, gestionnaires)
CREATE TABLE utilisateurs (
    id INT AUTO_INCREMENT PRIMARY KEY,
    nom VARCHAR(100),
    email VARCHAR(100) UNIQUE,
    mot_de_passe VARCHAR(255),
    role ENUM('citoyen', 'collecteur', 'entreprise', 'gestionnaire') NOT NULL,
    date_inscription TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

ALTER TABLE demandes MODIFY COLUMN statut ENUM('en attente', 'en cours', 'en attente_validation', 'validée', 'annulée') DEFAULT 'en attente';
ALTER TABLE demandes ADD preuve_photo VARCHAR(255) DEFAULT NULL;
ALTER TABLE profil_collecteurs ADD FOREIGN KEY (user_id) REFERENCES utilisateurs(id);

    statut ENUM('en attente', 'en cours', 'en attente_validation', 'validée', 'annulée') DEFAULT 'en attente',
    confirmation_collecteur BOOLEAN DEFAULT 0, -- 0 = pas encore confirmé, 1 = confirmé par le collecteur
    preuve_photo VARCHAR(255) DEFAULT NULL,

CREATE TABLE demandes (
    id INT AUTO_INCREMENT PRIMARY KEY,
    user_id INT NOT NULL,
    localisation VARCHAR(255),
    type_dechet ENUM('plastique', 'metal', 'organique', 'autre'),
    date_heure DATETIME,
    photo VARCHAR(255),
    statut ENUM('en attente', 'en cours', 'terminée', 'annulée') DEFAULT 'en attente',
    date_demande TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (user_id) REFERENCES utilisateurs(id),
    collecteur_id INT NULL,
    FOREIGN KEY (collecteur_id) REFERENCES collecteurs(id),
    latitude DECIMAL(9, 6),
    longitude DECIMAL(9, 6),
    confirmation_collecteur TINYINT(1) DEFAULT 0,
    statut ENUM('en attente', 'en cours', 'en attente_validation', 'validée', 'annulée') DEFAULT 'en attente',
    preuve_photo VARCHAR(255) DEFAULT NULL

);

ALTER TABLE collectes ADD COLUMN notif_vue BOOLEAN DEFAULT FALSE;


CREATE TABLE profil_collecteurs (
    id INT AUTO_INCREMENT PRIMARY KEY,
    nom VARCHAR(100) NOT NULL,
    telephone VARCHAR(20) NOT NULL UNIQUE,
    email VARCHAR(100) NOT NULL UNIQUE,
    adresse VARCHAR(255) NOT NULL,
    ville VARCHAR(100) NOT NULL,
    photo VARCHAR(255),
    statut ENUM('pas recruté', 'déjà recruté') DEFAULT 'pas recruté',
    date_creation TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    user_id INT NOT NULL,
    FOREIGN KEY (user_id) REFERENCES utilisateurs(id)
);

CREATE TABLE collecteurs (
    id INT AUTO_INCREMENT PRIMARY KEY,
    entreprise_id INT NOT NULL,
    nom VARCHAR(100) NOT NULL,
    telephone VARCHAR(20) NOT NULL,
    email VARCHAR(100) UNIQUE NOT NULL,
    adresse VARCHAR(255) NOT NULL,
    ville VARCHAR(100) NOT NULL,
    photo VARCHAR(255),
    statut ENUM('disponible', 'occupé') DEFAULT 'disponible',
    notifications TEXT DEFAULT NULL,
    FOREIGN KEY (entreprise_id) REFERENCES utilisateurs(id)
    collecteur_id INT NOT NULL;
);

CREATE TABLE notifications (
    id INT AUTO_INCREMENT PRIMARY KEY,
    message TEXT NOT NULL,
    type VARCHAR(50) NOT NULL,
    destinataire_role VARCHAR(50) NOT NULL,
    statut ENUM('non_lu', 'lu') DEFAULT 'non_lu',
    date TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    date_vue TIMESTAMP NULL DEFAULT NULL;

);



( ! ) Warning: Trying to access array offset on value of type bool in C:\wamp64\www\PROJETS\gestion_de_dechets\public\dashboard_collecteur.php on line 14

fait moi un bon, attirant et innovant css pour

ALTER TABLE collecteurs ADD collecteur_id INT NOT NULL;
ALTER TABLE collecteurs ADD FOREIGN KEY (collecteur_id) REFERENCES utilisateurs(id);

-- Table des collectes
CREATE TABLE collectes (
    id INT AUTO_INCREMENT PRIMARY KEY,
    utilisateur_id INT,
    adresse VARCHAR(255),
    type_dechet ENUM('plastique', 'métal', 'organique', 'autre') NOT NULL,
    statut ENUM('En attente', 'En cours', 'Terminé') DEFAULT 'En attente',
    date_demande TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (utilisateur_id) REFERENCES utilisateurs(id) ON DELETE CASCADE
);

-- Table des messages
CREATE TABLE messages (
    id INT AUTO_INCREMENT PRIMARY KEY,
    expediteur_id INT,
    destinataire_id INT,
    contenu TEXT,
    date_envoi TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (expediteur_id) REFERENCES utilisateurs(id),
    FOREIGN KEY (destinataire_id) REFERENCES utilisateurs(id)
);
